function deferCommentsContent(){window.jQuery?domReadyCommentsContent():setTimeout(function(){deferCommentsContent()},100)}document.addEventListener("DOMContentLoaded",function(){deferCommentsContent()});var Comments="",_eventsBoundToComments=!1,commentsMinLength=10,mentionarraydata="",Type="",ContentId="",CurrentUser="",CurrentRole="",CurrentUserPhoto="",ContentUserId="",AllowPost="true",LoginCheckReturnUrl="",pageSize=10,rootClass="",isApproved=!0,commentLoadedTimer=0,PreviousCommentId="";function domReadyCommentsContent(){if(isApproved=jQuery("#HiddenIsContentApproved").val(),mentionarraydata=[],Type=jQuery("#hddType").val(),ContentId=jQuery("#hddContentId").val(),CurrentUser=jQuery("#hddCurrentUser").val(),CurrentRole=jQuery("#hddCurrentRole").val(),jQuery("#HiddenCommentPageNumber").val("1"),CurrentUserPhoto=jQuery("#hddCurrentUserPhoto").val(),ContentUserId=jQuery("#hddContentUserId").val(),LoginCheckReturnUrl=jQuery("#hiddenLoginCheckUrl").val(),"false"==isApproved)return!1;Comments=(rootClass="."+Type+" ",{GetComments:function(e){var t=jQuery("#HiddenCommentPageNumber").val();jQuery(rootClass+"#RootComments"),jQuery.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/WebServices/Comments.asmx/GetComments",data:"{'id':'"+ContentId+"','type':'"+Type+"','pageNumber':'"+t+"', 'pageSize':'"+pageSize+"', 'parentId':"+e+"}",async:!1,beforeSend:function(){jQuery(rootClass+"#mainLoader").show()},success:function(e){ProcessComments(e.d,Type),wrapComments(),bindCachedComment()}})},LikeComment:function(e){var t;if(!VerifyUser())return window.location.href=LoginCheckReturnUrl,!1;if(jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=like_comment&id="+e+"&type="+Type,type:"POST",async:!1,beforeSend:function(){jQuery(rootClass+"#ajaxLoader_"+e).show()},success:function(o){t=o,jQuery(rootClass+"#ajaxLoader_"+e).hide()},Error:ShowError}),"1"==t){var o=jQuery(rootClass+"#Likes_"+e).text();jQuery(rootClass+"#Likes_"+e).text(parseFloat(o)+1)}else if("2"==t){var o=jQuery(rootClass+"#Likes_"+e).text();jQuery(rootClass+"#Likes_"+e).text(parseFloat(o)-1)}},DeleteComment:function(e,t){var o;if(!VerifyUser())return window.location.href=LoginCheckReturnUrl,!1;if(!confirm("Are you sure you want to delete this comment ?"))return!1;if(jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=delte_comment&id="+e+"&type="+Type,type:"POST",async:!1,success:function(e){o=e},Error:ShowError}),"1"==o){var n=jQuery(rootClass+"#Replies_"+e).text();if(jQuery(rootClass+"#comment_"+e).remove(),0==t)ManageAlternateColor(),ManagePaging("d",n),0==GetParentCommentsCount()&&Comments.GetComments(0);else{var a=jQuery(rootClass+"#Replies_"+t).text(),s=jQuery(rootClass+"#TotalComments"),i=jQuery(rootClass+"#CommentCount");jQuery(rootClass+"#Replies_"+t).text(parseFloat(a)-1);var r=parseFloat(s.data("total-count"))-1;0===r?s.text("0"):s.text(r),s.data("total-count",r),i.text(parseFloat(GetParentCommentsCount())+parseFloat(GetChildCommentsCount())),jQuery("#spanComments").text(r)}0===parseInt(jQuery(rootClass+"#TotalComments").data("total-count"))&&jQuery(rootClass+"#TotalComments").text("0")}},PostComment:function(e,t){var o=null;if(jQuery("textarea.mention").mentionsInput("val",function(e){o=e}),o=(o=GetCommentData(o=FormatText(o),"textarea.mention")).charAt(0).toUpperCase()+o.slice(1),13==t.keyCode){var n=jQuery(rootClass+"#RootComments");if(jQuery("#HiddenTotalComments"),jQuery(rootClass+"#CommentCount"),jQuery("<p>"+unescape(o)+"</p>").clone().find("a").remove().end().text().trim().replace(/\s+/g," ").length<commentsMinLength)return setTimeout(function(){jQuery(".comment-hint").length>0&&jQuery(".comment-hint").remove();var e=document.createElement("span");e.setAttribute("style","z-index:1;position: absolute;right: 0px;top: 56px;background:#fff;color: red;padding: 2px 5px;border: 1px solid #e8e8e8;border-left: 4px solid red;box-sizing: border-box;padding-left: 13px;"),e.innerHTML="Comment can't be less than "+commentsMinLength+" characters.",jQuery(e).insertAfter(jQuery("textarea.mention")),setTimeout(function(){jQuery(e).fadeOut(500,function(){jQuery(e).remove()})},4e3)},50),t.preventDefault(),!1;if(""!=o){if(!VerifyUser()){var a={commentId:e,Comment:o};return localStorage.setItem(Type+"_"+ContentId,JSON.stringify(a)),window.location.href=LoginCheckReturnUrl,!1}jQuery.ajax({url:"/WebServices/Comments.asmx/InsertComment",data:"{'content_id':'"+ContentId+"','type':'"+Type+"','parent_id':'"+e+"', 'description':"+JSON.stringify(o)+"}",type:"POST",contentType:"application/json; charset=utf-8",async:!1,beforeSend:function(){jQuery(rootClass+"#PostLoader").show();var t={commentId:e,Comment:o};localStorage.setItem(Type+"_"+ContentId,JSON.stringify(t))},success:function(a){localStorage.removeItem(Type+"_"+ContentId);var s=a.d[0],i=[],r=null;jQuery("textarea.mention").mentionsInput("getMentions",function(e){jQuery.each(e,function(e,t){i.push(t.id)})}),jQuery("textarea.mention").mentionsInput("reset",function(e){}),n.prepend(BuildComment(s)),jQuery("#comment_"+s.CommentId).hide().slideDown(500,function(){jQuery(this).attr("style","")}),jQuery("#ctl00_RootPostComment .image img").length>0&&jQuery("#ctl00_RootPostComment img").attr("src")!=s.PhotoUrl&&jQuery("#ctl00_RootPostComment img").attr("src",s.PhotoUrl).attr("title",s.FullName).attr("alt",s.FullName),ManageAlternateColor(),jQuery(rootClass+"#InputCommentText_"+e).val("").trigger("autosize.resize"),parseFloat(GetParentCommentsCount())>parseFloat(pageSize)&&jQuery("#RootComments > div").last().remove(),ManagePaging("i",0),SendMail(o,"0",s.ParentUserId,s.CommentId),i.length>0&&SendNotification(o,r=i.join(",")),jQuery(rootClass+"#PostLoader").hide(),PreventDefault(t)},Error:ShowError})}else PreventDefault(t)}},ShowReplyBox:function(e){var t=jQuery(rootClass+"#CommentReplies_"+e);if(jQuery(rootClass+"#CommentReplies_"+e+" #ReplyContainer_"+e).length)jQuery(rootClass+"#CommentReplies_"+e+" #ReplyContainer_"+e+":visible").length>0?(jQuery(".esc-msg").remove(),jQuery(rootClass+"#CommentReplies_"+e+" #ReplyContainer_"+e).hide()):jQuery(rootClass+"#CommentReplies_"+e+" #ReplyContainer_"+e).show();else{var o=buildPostReplyBox(e,CurrentUserPhoto);t.append(o),jQuery(rootClass+"textarea#ReplyComment_"+e).elastic(),GetValueAtTheRate(rootClass+"textarea#ReplyComment_"+e),jQuery(rootClass+"#ReplyComment_"+e).focus(),jQuery(".esc-msg").remove(),removePrevComment(),PreviousCommentId="#ReplyContainer_"+e}jQuery(rootClass+"#CommentReplies_"+e).show()},ShowReplies:function(e,t){var o=jQuery(rootClass+"#CommentReplies_"+e),n=jQuery(rootClass+"#CommentCount");"0"!=jQuery(rootClass+"#Replies_"+e).text()&&jQuery.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/WebServices/Comments.asmx/GetComments",data:"{'id':'"+ContentId+"','type': '"+Type+"','pageNumber':'1', 'pageSize':'50', 'parentId':"+e+"}",beforeSend:function(){jQuery(rootClass+"#ajaxLoader_"+e).show()},success:function(a){var s=a.d;o.html("");var i=s[0];jQuery.each(i,function(e){i[e].CommentId,o.prepend(BulildCommentReply(i[e]))}),jQuery(rootClass+"#ajaxLoader_"+e).hide(),jQuery(t).remove(),jQuery("#CommentReplies_"+e).show(),n.text(parseFloat(GetParentCommentsCount())+parseFloat(GetChildCommentsCount()))}})},ToggleReplies:function(e){jQuery(rootClass+"#CommentReplies_"+e).html().length&&(jQuery(rootClass+"#CommentReplies_"+e+" .commentDescription").length>0||jQuery(rootClass+"#ReplyContainer_"+e).is(":visible"))&&jQuery(rootClass+"#CommentReplies_"+e).toggle()},PostCommentReply:function(e,t){var o=null;if(jQuery(rootClass+"#ReplyComment_"+e).mentionsInput("val",function(e){o=e}),o=(o=GetCommentData(o=FormatText(o),rootClass+"#ReplyComment_"+e)).charAt(0).toUpperCase()+o.slice(1),13==t.keyCode){var n=jQuery(rootClass+"#ReplyContainer_"+e),a=jQuery(rootClass+"#TotalComments"),s=jQuery(rootClass+"#CommentCount");if(jQuery("<p>"+unescape(o)+"</p>").clone().find("a").remove().end().text().trim().replace(/\s+/g," ").length<commentsMinLength)return setTimeout(function(){jQuery(jQuery(".reply-comment-hint").length>0),jQuery(".reply-comment-hint pull-right").remove();var t=document.createElement("span");t.setAttribute("style","z-index:1;position: absolute;right: 0px;bottom: -20px;background:#fff;color: red;padding: 2px 5px;border: 1px solid #e8e8e8;border-left: 4px solid red;box-sizing: border-box;padding-left: 13px;z-index:1"),t.innerHTML="Comment can't be less than "+commentsMinLength+" characters.",jQuery(t).insertAfter(jQuery(rootClass+"#ReplyComment_"+e).parent().parent()),setTimeout(function(){jQuery(t).fadeOut(500,function(){jQuery(t).remove()})},4e3)},50),t.preventDefault(),!1;if(jQuery(rootClass+"#ReplyComment_"+e).mentionsInput("reset",function(e){}),""!=o){if(!VerifyUser()){var i={commentId:e,Comment:o};return localStorage.setItem(Type+"_"+ContentId,JSON.stringify(i)),window.location.href=LoginCheckReturnUrl,!1}jQuery.ajax({url:"/WebServices/Comments.asmx/InsertComment",data:"{'content_id':'"+ContentId+"','type':'"+Type+"','parent_id':'"+e+"', 'description':'"+o+"'}",type:"POST",contentType:"application/json; charset=utf-8",async:!1,beforeSend:function(){jQuery(rootClass+"#PostLoader_"+e).show();var t={commentId:e,Comment:o};localStorage.setItem(Type+"_"+ContentId,JSON.stringify(t))},success:function(i){localStorage.removeItem(Type+"_"+ContentId);var r=i.d[0];n.before(BulildCommentReply(r)),n.find(".image img").length>0&&n.find(".image img").attr("src")!=r.PhotoUrl&&n.find(".image img").attr("src",r.PhotoUrl).attr("title",r.FullName).attr("alt",r.FullName),jQuery(rootClass+"#ReplyComment_"+e).val("").trigger("autosize.resize");var m=jQuery(rootClass+"#Replies_"+e).text();jQuery(rootClass+"#Replies_"+e).text(parseFloat(m)+1);var l=parseFloat(a.data("total-count"))+1;0===l?a.text("0"):a.text(l),a.data("total-count",l),s.text(parseFloat(GetParentCommentsCount())+parseFloat(GetChildCommentsCount())),jQuery("#spanComments").text(l),SendMail(o,"1",r.ParentUserId,r.CommentId),jQuery(rootClass+"#PostLoader_"+e).hide(),PreventDefault(t)},Error:ShowError})}else PreventDefault(t)}},ShowEditView:function(e){var t=jQuery(rootClass+"#comment_"+e+" .commentDescription div:eq(0) .icon-edit-content2"),o=jQuery(rootClass+"#comment_"+e+" .commentDescription div:eq(1)");t.hide().next().hide(),t.prev().hide(),o.after('<textarea id="CommentToEdit_'+e+'" onkeyup="Comments.RemovePreviousComment('+e+",this,event,'edit');\" onkeypress=\"Comments.EditComment("+e+',event);" class="form-control" spellcheck="true"  onfocus="this.value = this.value;" style="margin-bottom:4px;"  ></textarea>                <img id="ajaxLoaderEdit_'+e+'" src="/Images/csharp/ajax-loader-small.gif" class="hide" alt="Loading..." />');var n=o.html(),a=n.match(/<a[^>]+>([^<]+)<\/a>/g),s=null,i=null;if(a)for(var r=0;r<=a.length-1;r++)s=jQuery(a[r]).attr("href"),i=a[r].match(/<a[^>]+>([^<]+)<\/a>/)[1],mentionarraydata.push(i+"/^g*~o0#g*^/"+s),n=n.replace(a[r],i);jQuery(rootClass+"#CommentToEdit_"+e).focus(),jQuery(rootClass+"#CommentToEdit_"+e).val(n),o.hide(),jQuery(rootClass+"textarea#CommentToEdit_"+e).elastic(),removePrevComment(),PreviousCommentId=e,jQuery(".esc-msg").remove();var m=document.createElement("span");m.innerHTML="Press Esc key to cancel",m.setAttribute("class","esc-msg hidden-md-down"),m.setAttribute("style","color:#ff0000;margin-left: 70px;display:block;margin-bottom:-12px;"),jQuery("#comment_"+e).before(m)},EditComment:function(e,t){var o=jQuery(rootClass+"#CommentToEdit_"+e),n=jQuery(rootClass+"#CommentToEdit_"+e).val().trim();if(n=GetEditData(n=FormatText(n)),13==t.keyCode){var a,s=jQuery(rootClass+"#comment_"+e+" .commentDescription div:eq(1)");if(o.val(o.val().replace("\n","")),jQuery("<p>"+unescape(n)+"</p>").clone().find("a").remove().end().text().trim().replace(/\s+/g," ").length<commentsMinLength)return setTimeout(function(){jQuery(".comment-hint").length>0&&jQuery(".comment-hint").remove();var t=document.createElement("span");t.setAttribute("style","z-index:1;position: absolute;right: 0px;top: 56px;background:#fff;color: red;padding: 2px 5px;border: 1px solid #e8e8e8;border-left: 4px solid red;box-sizing: border-box;padding-left: 13px;z-index:1"),t.innerHTML="Comment can't be less than "+commentsMinLength+" characters.",jQuery(t).insertAfter(jQuery(rootClass+"#CommentToEdit_"+e)),setTimeout(function(){jQuery(t).fadeOut(500,function(){jQuery(t).remove()})},4e3)},50),t.preventDefault(),!1;if(n==s.text()||""==n)RemoveEditView(e),jQuery(".esc-msg").remove(),removePrevComment(),PreviousCommentId="",PreventDefault(t);else{if(!VerifyUser())return window.location.href=LoginCheckReturnUrl,!1;jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=edit_comment&id="+e+"&type="+Type,type:"POST",async:!1,data:{description:n},beforeSend:function(){jQuery(rootClass+"#ajaxLoaderEdit_"+e).show()},success:function(e){a=e,PreventDefault(t),mentionarraydata.length=0,jQuery(".esc-msg").remove(),removePrevComment(),PreviousCommentId=""},Error:ShowError}),"1"==a&&(s.html(decodeURIComponent(n)),RemoveEditView(e))}}},UpdateFollowStatus:function(e){var t;t=!!jQuery(e).is(":checked"),jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=comment_follow_status&id="+ContentId+"&type="+Type+"&status="+t,type:"POST",async:!1,beforeSend:function(){jQuery(rootClass+"#PostLoader").show()},success:function(e){"1"==e&&jQuery(rootClass+"#PostLoader").hide()},Error:ShowError})},ViewPreviousComments:function(){var e=jQuery("#HiddenCommentPageNumber").val();parseFloat(jQuery("#HiddenTotalComments").val())>parseFloat(e)*pageSize?jQuery("#HiddenCommentPageNumber").val(parseFloat(e)+1):(jQuery(rootClass+"#RootComments").text(""),jQuery("#HiddenCommentPageNumber").val("1")),Comments.GetComments(0)},ShowEditorOptions:function(e,t){jQuery(e).find(".comment-parent:first").show()},HideEditorOptions:function(e,t){jQuery(e).find(".comment-parent:first").hide()},ShowEditorOptionsReply:function(e,t){jQuery(e).find(".comment-child:first").show(),jQuery(e).parent().siblings().find(".comment-parent").hide(),t.stopPropagation()},HideEditorOptionsReply:function(e,t){jQuery(e).find(".comment-child:first").hide(),t.stopPropagation()},ReportComment:function(e,t,o,n,a){return!!confirm("Are you sure you want to report this comment?")&&(jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=report_comment&CommentId="+e+"&Comment="+o+"&CommentedBy="+t+"&ContenType="+Type+"&CommentedByUrl="+n+"&CommentedByFullName="+a,type:"POST",success:function(e){"Login"==e?window.location="/login?returnurl="+window.location.href:"1"==e?alert("Successfully Reported."):"2"==e?alert("Already Reported."):console.log("Error")},error:function(e){console.log(e)}}),!1)},RemovePreviousComment:function(e,t,o,n){if(jQuery(".esc-msg").remove(),27===o.keyCode)switch(PreviousCommentId="",jQuery(t).val(""),jQuery(".mentions-autocomplete-list").hide(),jQuery("div.mentions>div").html(""),n){case"edit":RemoveEditView(e);break;case"reply":jQuery("#ReplyContainer_"+e).remove()}else if(jQuery(t).val().trim().length>0){var a=document.createElement("span");switch(a.innerHTML="Press Esc key to cancel",a.setAttribute("class","esc-msg hidden-md-down"),a.setAttribute("style","color:#ff0000;margin-left: 70px;display:block;margin-bottom:-12px;"),n){case"reply":jQuery("#ReplyContainer_"+e).before(a),jQuery("#InputCommentText_0").val("");break;case"post":jQuery(".comment-body").prepend(a),removePrevComment(),PreviousCommentId="";break;case"edit":jQuery("#comment_"+e).before(a),jQuery("#InputCommentText_0").val("")}}}}),"common"==jQuery("#HiddenProcessType").val()?(Comments.GetComments(0),GetValueAtTheRate("textarea.mention"),jQuery("#CommentIcon,#CommentIcon2").click(function(){jQuery("#InputCommentText_0").focus()})):GetArticleCommnets(),jQuery.ajaxSetup({cache:!1}),void 0==jQuery("#hddAllowPost").val()&&(AllowPost=jQuery("#HiddenIsAllowPost").val()),void 0!=AllowPost&&"false"==AllowPost.toLowerCase()&&jQuery("#RootPostComment").remove(),jQuery(document).on("click",function(e){"mention"===e.target.className?jQuery(".mentions-autocomplete-list").has("ul").show():jQuery(".mentions-autocomplete-list").hide()}),jQuery('a[href="#ReadAndPostComment"]').on("click",function(){jQuery(".accordianAnchor.plus").length>0&&jQuery(".accordianAnchor.plus").click()}),window.location.hash.indexOf("ReadAndPostComment")>-1&&function e(){jQuery(".mention").length>0?(jQuery(".accordianAnchor.plus").click(),0==jQuery(window).scrollTop()&&jQuery("html,body").animate({scrollTop:jQuery(".mention").offset().top},1e3)):(clearTimeout(commentLoadedTimer),commentLoadedTimer=setTimeout(function(){e()},300))}()}function PreventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function GetParentCommentsCount(){return jQuery(rootClass+"#RootComments > div.media").length}function GetChildCommentsCount(){var e=jQuery(rootClass+"#RootComments > div.pulsecomment div.commentcontent div div.ReplyComment").length,t=jQuery(rootClass+"#RootComments > div.pulsecomment div.commentcontent textarea").length;return e>0?e-t:0}function ManageAlternateColor(){jQuery(rootClass+"#RootComments > div").removeClass("BackgroundWhite"),jQuery(rootClass+"#RootComments > div:odd").addClass("BackgroundWhite")}function SendMail(e,t,o,n){var a=jQuery("#hddContentUserEmail").val();jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=send_mail&type="+Type,data:{description:unescape(e),content_title:jQuery("#hddContentTitle").val(),content_user_id:ContentUserId,is_child_comment:t,content_id:ContentId,parent_user_id:o,request_url:window.location.protocol+"//"+window.location.hostname+window.location.pathname,content_url:window.location.pathname,content_user_email:a,comment_id:n},type:"POST",async:!1,success:function(e){}})}function SendNotification(e,t){var o=window.location.href;jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=send_notification&type="+Type,data:{description:unescape(e),mailtosend:t,currenturl:o},type:"POST",async:!1,success:function(e){}})}function VerifyUser(){var e;return LoginCheckReturnUrl=jQuery("#hiddenLoginCheckUrl").val(),jQuery.ajax({url:"/Handlers/CommentsHandler.ashx?method=current_user",type:"GET",async:!1,success:function(t){e=jQuery.parseJSON(t)[0].user_name}}),null!=e&&""!=e}function ManagePaging(e,t){var o=jQuery(rootClass+"#TotalComments"),n=jQuery(rootClass+"#CommentCount"),a=jQuery.trim(jQuery("#HiddenTotalComments").val()),s=o.data("total-count");switch(e){case"i":a=parseFloat(a)+1,0===(s=""===s||"0"===s?1:parseFloat(s)+1)?o.text(""):o.text(s),o.data("total-count",s),jQuery(rootClass+"#Paging").show();break;case"d":0>=parseFloat(a)?(o.text("0"),n.text(""),jQuery(rootClass+"#Paging").hide()):(s=parseFloat(s)-(1+parseFloat(t)),o.text(s),o.data("total-count",s),a=parseFloat(a)-1)}var i=parseFloat(GetParentCommentsCount());n.text(i+parseFloat(GetChildCommentsCount())),jQuery("#HiddenTotalComments").val(a),jQuery("#HiddenCommentPageNumber").val(parseInt((i-1)/pageSize)+1),ManageViewMoreVisibility(),jQuery("#spanComments").text(s)}function ManageViewMoreVisibility(){jQuery("#ViewPreviousComments");var e=jQuery("#loadmoreComments");parseFloat(jQuery("#HiddenTotalComments").val())>parseFloat(GetParentCommentsCount())||e.hide()}function RemoveEditView(e){var t=jQuery(rootClass+"#comment_"+e+" .commentDescription div:eq(1)"),o=jQuery(rootClass+"#comment_"+e+" .commentDescription div:eq(0) .icon-edit-content2"),n=jQuery(rootClass+"#CommentToEdit_"+e),a=jQuery(rootClass+"#ajaxLoaderEdit_"+e);o.show().next().show(),o.prev().show(),n.val(""),n.remove(),a.remove(),t.show()}function ShowError(){alert("There is some error processing your request")}function GetValueAtTheRate(e){jQuery(e).mentionsInput({minChars:1,onDataRequest:function(e,t,o){jQuery.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/WebServices/CSharpSearch.asmx/GetAllFriendsFollowers",data:"{'name':'"+t+"','user_id':'"+CurrentUser+"','content_id':'"+ContentId+"','type':'"+Type+"'}",async:!1,success:function(e){for(var t=e.d,n=[],a=null,s=null,i=null,r=null,m=0;m<=t.length-1;m++){a=t[m].Id,s=t[m].Name,i=t[m].PhotoUrl,r=t[m].AuthorUrl;var l=new JasonObj(a,s,i,r);n.push(l)}o.call(this,n)}})}})}var JasonObj=function(e,t,o,n){this.id=e,this.name=t,this.avatar=o,this.type=n};function GetCommentData(e,t){var o=null,n=null,a=null;return jQuery(t).mentionsInput("getMentions",function(t){jQuery.each(t,function(t,s){n=FormatText(o="@["+s.value+"]("+s.type+":"+s.id+")"),a='<a target="_blank" class="LinkNormalBlue" href="'+decodeURIComponent(s.type)+'">'+s.value+"</a>",e=e.replace(n,a)})}),e}function FormatText(e){return escape(jQuery.trim(e).replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace("/","&#47;").replace('"',"&quot;").replace("\n","").replace("\\","&#92;"))}function GetEditData(e){if(e=unescape(e),mentionarraydata){for(var t=null,o=null,n=0;n<=mentionarraydata.length-1;n++)t=mentionarraydata[n].split("/^g*~o0#g*^/")[0],o=mentionarraydata[n].split("/^g*~o0#g*^/")[1],-1!==e.indexOf(t)&&(e=e.replace(t,"<a target=_blank class=LinkNormalGray href="+o+">"+t+"</a>"));mentionarraydata.indexOf(0)}return escape(e)}function GetArticleCommnets(){var e=jQuery("#hddArticleID").val(),t=jQuery("#HiddenAuthorId").val(),o="";jQuery("#HiddenFiledContentTitle").length>0&&(o=jQuery("#HiddenFiledContentTitle").val().replace("'","\\'"));var n=jQuery("#HiddenContentType").val(),a=jQuery("#hddRawUrl").val();IsAllowPost=jQuery("#HiddenIsAllowPost").val(),jQuery.ajax({type:"POST",url:"/WebServices/CommonServices.asmx/GetArticleCommentsNew",data:"{'ContentId':'"+e+"','ContentUserId':'"+t+"','ContentTitle':'"+o+"','Type':'"+n+"','articleRawUrl':'"+a+"','pageSize':'"+pageSize+"','pageNumber':'1','isAllowPost':'"+IsAllowPost+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){e.d.html.length>0&&(jQuery(".commentsContainer").append(e.d.html),VariableInitialization(),getTotalComments(e.d.comments,n),wrapComments(),bindCachedComment())},complete:function(){GetValueAtTheRate("textarea.mention"),jQuery("#CommentIcon,#CommentIcon2").click(function(){jQuery("#InputCommentText_0").focus()})}})}function bindCachedComment(){var e=localStorage.getItem(Type+"_"+ContentId);null!==e&&(0==(e=JSON.parse(localStorage.getItem(Type+"_"+ContentId))).commentId?jQuery("#InputCommentText_0").val(unescape(e.Comment)):(Comments.ShowReplyBox(e.commentId),jQuery("#ReplyComment_"+e.commentId).val(unescape(e.Comment))))}function getTotalComments(e,t){var o,n=e,a=n[0];jQuery((rootClass="."+t+" ")+"#RootComments");var s=jQuery("#HiddenCommentPageNumber").val(),i=0,r=0;jQuery.each(a,function(e){1==s&&0==e&&(r=1,0===(o=null==n[2][e]||void 0==n[2][e]?a[e].TotalComments:parseFloat(a[e].TotalComments)+parseFloat(n[2][e].TotalComments))?jQuery(rootClass+"#TotalComments").text(""):jQuery(rootClass+"#TotalComments").text(o),jQuery(rootClass+"#TotalComments").data("total-count",o),jQuery("#spanComments").text(o)),i=parseFloat(i)+1,ManageAlternateColor()}),1==r&&(jQuery("#ViewPreviousComments").show(),r=0)}function ProcessComments(e,t){var o=e,n=o[0],a=jQuery((rootClass="."+t+" ")+"#RootComments"),s=jQuery("#HiddenCommentPageNumber").val(),i=0;if(jQuery("#ViewPreviousComments").hide(),jQuery("#loadmoreComments").show(),void 0==n[0])jQuery(rootClass+"#mainLoader").hide(),jQuery(rootClass+"#Paging").hide();else{jQuery.each(n,function(e){a.append(BuildComment(n[e])),1==s&&0==e&&(jQuery("#HiddenTotalComments").val(n[e].TotalComments),0===(r=null==o[2][e]||void 0==o[2][e]?n[e].TotalComments:parseFloat(n[e].TotalComments)+parseFloat(o[2][e].TotalComments))?jQuery(rootClass+"#TotalComments").text(""):jQuery(rootClass+"#TotalComments").text(r),jQuery(rootClass+"#TotalComments").data("total-count",r),jQuery("#spanComments").text(r)),i=parseFloat(i)+1,ManageAlternateColor()});var r,m,l=o[1];jQuery.each(l,function(e){(m=jQuery(rootClass+"#CommentReplies_"+l[e].ParentId)).prepend(BulildCommentReply(l[e])),i=parseFloat(i)+1}),0!=i&&parseFloat(s)>=1?1==parseFloat(s)?jQuery(rootClass+"#CommentCount").text(i):jQuery(rootClass+"#CommentCount").text(parseFloat(jQuery(rootClass+"#CommentCount").text())+i):jQuery(rootClass+"#Paging").hide(),ManageViewMoreVisibility(),jQuery(rootClass+"#mainLoader").hide()}jQuery("#HiddenIsAllowPost").length>0&&"false"==jQuery("#HiddenIsAllowPost").val()&&jQuery("#RootPostComment").hide()}function VariableInitialization(){rootClass=Type=jQuery("#hddType").val(),ContentId=jQuery("#hddContentId").val(),CurrentUserPhoto=jQuery("#hddCurrentUserPhoto").val(),ContentUserId=jQuery("#hddContentUserId").val(),AllowPost=jQuery("#hddAllowPost").val(),LoginCheckReturnUrl=jQuery("#hiddenFieldReturnUrl").val(),CurrentUser=jQuery("#hddCurrentUser").val(),CurrentRole=jQuery("#hddCurrentRole").val()}function wrapComments(){_eventsBoundToComments||(jQuery("#divViewPreviousComments").hide(),jQuery(".accordianDetail").hide(),jQuery(".accordianAnchor").click(function(){jQuery(this).hasClass("plus")?(jQuery(this).removeClass("plus").addClass("minus"),jQuery(".accordianDetail").slideDown("slow"),ManageViewMoreVisibility(),jQuery("#divViewPreviousComments").show(),jQuery(".mentions+#InputCommentText_0").focus()):(jQuery(this).removeClass("minus").addClass("plus"),jQuery(".accordianDetail").slideUp("slow"),jQuery("#divViewPreviousComments").hide())}),jQuery("#commentsBox").click(function(){jQuery(".accordianAnchor").click()}),_eventsBoundToComments=!0,jQuery(this).removeClass("plus").addClass("minus"),jQuery(".accordianDetail").slideDown("slow"),ManageViewMoreVisibility(),jQuery("#divViewPreviousComments").show())}function BuildComment(e){var t,o=e.AuthorUrl,n=unescape(e.Description);t='<div class="media" id="comment_'+e.CommentId+'" onmouseover="Comments.ShowEditorOptions(this,event);" onmouseout="Comments.HideEditorOptions(this,event);" >',t+='<div class="media-left"><a href="'+o+'"><img class="user-image-56" alt="'+e.FullName+'" title="'+e.FullName+'" src="'+e.PhotoUrl+'" /></a></div>',t+='<div class="media-body"><div class="commentDescription">',t+='<div class="comment-action-button comment-parent">',CurrentUser==e.UserId||"E"==CurrentRole||"A"==CurrentRole?((CurrentUser==e.UserId||"A"==CurrentRole)&&(t+='<a onclick="Comments.DeleteComment('+e.CommentId+","+e.ParentId+')" title="Delete" href="javascript:void(0)"  class="d-icon icon-delete-content2"></a>'),t+='<a onclick="Comments.ShowEditView('+e.CommentId+')" href="javascript:void(0)" title="Edit" class="d-icon icon-edit-content2"></a>',CurrentUser!=e.UserId&&(t+='<a class="icon-20 d-icon icon-flag" href="javascript:void(0)" onclick="return Comments.ReportComment('+e.CommentId+",'"+e.UserId+"','"+escape(n)+"','"+o+"','"+e.FullName+'\');" title="Report this comment"></a> ')):t+='<a class="d-icon icon-flag" href="javascript:void(0)" onclick="return Comments.ReportComment('+e.CommentId+",'"+e.UserId+"','"+escape(n)+"','"+o+"','"+e.FullName+'\');" title="Report this comment"></a> ',t+='</div><div data-comment class="commentDescription">'+n+"</div>",t+='<div class="comment-info clearfix">                    <span class="comment-time">                    <i class="d-icon icon-clock-small"></i>'+e.CreatedDate+'</span><a href="'+e.AuthorUrl+'" alt="'+e.FullName+'">'+e.FullName+"</a></div>";var a=e.AuthorRank,s="Rank";return e.IsInternal&&(a="A"==e.UserType?"Admin":"E"==e.UserType?"Editor":"Tech Writer",s="A"==e.UserType?"Admin":"E"==e.UserType?"Editor":"Tech Writer"),t+='<div class="comment-info clearfix">',t+='<span class="rpv-wrapper">                    <span title="'+s+'"><i class="d-icon icon-author-r"></i>'+a+'</span>                    <span title="Reputation"><i class="d-icon icon-author-p"></i>'+e.AuthorPoints+'</span>                    <span title="Total Views"><i class="d-icon icon-author-v"></i>'+e.AuthorReadCount+"</span></span>",t+='<ul class="list-inline comment-reply-wrapper">                    <li title="Likes">                        <img alt="Loading..." id="ajaxLoader_'+e.CommentId+'" src="/Images/csharp/ajax-loader-small.gif" style="margin:4px 0px 0px 5px;" class="hide" />                        <a href="javascript:void(0)" onclick="Comments.LikeComment('+e.CommentId+')">                        <i class="v-middle icon-20 d-icon icon-like-small"></i><span id="Likes_'+e.CommentId+'" class="text-grey-600">'+e.Likes+'</span> </a></li>                    <li title="Replies"><a href="javascript:void(0)" onclick="Comments.ToggleReplies('+e.CommentId+')" >                    <i class="v-middle icon-20 d-icon icon-reply-small"></i>                    <span id="Replies_'+e.CommentId+'" class="text-grey-600">'+e.Replies+"</span> </a></li>","true"==AllowPost.toLowerCase()&&(t+='<li class="text-grey-600">                            <a class="text-grey-600" href="javascript:void(0)" onclick="Comments.ShowReplyBox('+e.CommentId+')" title="Post Reply">                            <i class="v-middle icon-20 d-icon icon-reply-all-small"></i>Reply</a></li>'),parseFloat(e.Replies)>3&&(t+='<li class="reply-collapse">                            <a href="javascript:void(0)" onclick="Comments.ShowReplies('+e.CommentId+', this)" title="Show All">                            <i class="text-icon">'+e.Replies+"</i></a></li>"),t+="</ul></div>",t+='<div class="media comment-replies" id="CommentReplies_'+e.CommentId+'"></div>',t+="</div>"}function BulildCommentReply(e){var t,o=e.AuthorUrl,n=unescape(e.Description),t='<div class="media" id="comment_'+e.CommentId+'" onmouseover="Comments.ShowEditorOptionsReply(this,event);" onmouseout="Comments.HideEditorOptionsReply(this,event);" >';t+='<div class="media-left"><a href="'+o+'"><img class="user-image-56" alt="'+e.FullName+'" title="'+e.FullName+'" src="'+e.PhotoUrl+'" /></a></div>',t+='<div class="media-body"><div class="commentDescription">',t+='<div class="comment-action-button comment-child">',CurrentUser==e.UserId||"E"==CurrentRole||"A"==CurrentRole?((CurrentUser==e.UserId||"A"==CurrentRole)&&(t+='<a onclick="Comments.DeleteComment('+e.CommentId+","+e.ParentId+')" title="Delete" href="javascript:void(0)"  class="d-icon icon-delete-content2"></a>'),t+='<a onclick="Comments.ShowEditView('+e.CommentId+')" title="Edit" href="javascript:void(0)" class="d-icon icon-edit-content2"></a>',CurrentUser!=e.UserId&&(t+='<a class="d-icon icon-flag" href="javascript:void(0)" onclick="return Comments.ReportComment('+e.CommentId+",'"+e.UserId+"','"+escape(n)+"','"+o+"','"+e.FullName+'\');" title="Report this comment"></a> ')):t+='<a href="javascript:void(0)" class="d-icon icon-flag" onclick="return Comments.ReportComment('+e.CommentId+",'"+e.UserId+"','"+escape(n)+"','"+o+"','"+e.FullName+'\');" title="Report this comment"></a> ',t+='</div><div data-comment class="commentDescription">'+n+"</div>",t+='<div class="comment-info clearfix">                    <span class="comment-time">                    <i class="d-icon icon-clock-small"></i>'+e.CreatedDate+'</span><a href="'+e.AuthorUrl+'" alt="'+e.FullName+'">'+e.FullName+"</a></div>";var a=e.AuthorRank,s="Rank";return e.IsInternal&&(a="A"==e.UserType?"Admin":"E"==e.UserType?"Editor":"Tech Writer",s="A"==e.UserType?"Admin":"E"==e.UserType?"Editor":"Tech Writer"),t+='<div class="comment-info clearfix">',t+='<span class="rpv-wrapper">                    <span title="'+s+'"><i class="d-icon icon-author-r"></i>'+a+'</span>                    <span title="Reputation"><i class="d-icon icon-author-p"></i>'+e.AuthorPoints+'</span>                    <span title="Total Views"><i class="d-icon icon-author-v"></i>'+e.AuthorReadCount+"</span></span>  ",t+='<ul class="list-inline comment-reply-wrapper">                    <li title="Likes">                    <img alt="Loading..." id="ajaxLoader_'+e.CommentId+'" src="/Images/csharp/ajax-loader-small.gif" class="hide" />                    <a href="javascript:void(0)" onclick="Comments.LikeComment('+e.CommentId+')">                        <i class="v-middle icon-20 d-icon icon-like-small"></i><span id="Likes_'+e.CommentId+'" class="text-grey-600">'+e.Likes+"</span> </a>                    </li></ul>",t+="</div>",t+="</div>"}function buildPostReplyBox(e,t){return'<div class="media" id="ReplyContainer_'+e+'">                            <div class="media-left">                            <img src="'+t+'" alt="Author Photo" class="user-image-56"></div>                            <div class="media-body reply-comment-box">                            <textarea id="ReplyComment_'+e+'" onkeyup="Comments.RemovePreviousComment('+e+",this,event,'reply');\" onkeypress=\"Comments.PostCommentReply("+e+',event);" class="form-control" spellcheck="true" placeholder="Type your comment here and press Enter Key (Minimum '+commentsMinLength+' characters)"></textarea>                            <img id="PostLoader_'+e+'" src="/images/csharp/ajax-loader-small.gif" alt="Loading..." class="hide">                            </div></div>'}function removePrevComment(){""!=PreviousCommentId&&("number"!=typeof PreviousCommentId?jQuery(PreviousCommentId).remove():RemoveEditView(PreviousCommentId))}