function deferEmotionLoad(){window.jQuery?domReadyForEmotion():setTimeout(function(){deferEmotionLoad()},100)}function domReadyForEmotion(){setTimeout(createEmotionCopy,0);jQuery("#btnLikeAnchor").mouseover(function(n){jQuery("#btnLikeAnchor").addClass("like-button");n.preventDefault()});jQuery("#btnLikeAnchor").mouseleave(function(n){jQuery("#emotionsContainer").removeAttr("style");n.preventDefault()})}function getContentReactions(n,t){isPopupOpend||(isPopupOpend=!0,GenerateReactionContainer(),BindingReactionData(n,t))}function GenerateReactionContainer(){mainReactionContainer=document.createElement("div");mainReactionContainer.className="modal fade in";mainReactionContainer.style.background="rgba(0,0,0,0.3)";mainReactionContainer.tabIndex=-1;var n=document.createElement("div");n.className="modal-dialog";n.style.maxWidth="430px";emotionPopupWrapper=document.createElement("div");emotionPopupWrapper.className="modal-content emotion-popup-wrapper";emotionPopupWrapper.id="emotionPopupWrapper";n.appendChild(emotionPopupWrapper);mainReactionContainer.appendChild(n)}function BindingReactionData(n,t){jQuery.ajax({url:"/WebServices/CommonServices.asmx/GetContentReactions",type:"post",data:JSON.stringify({ContentId:n,ContentType:t}),dataType:"json",contentType:"application/json",beforeSend:function(){jQuery("emotion-loader").show()},success:function(n){emotions=JSON.parse(n.d);var t=groupBy(emotions,"Icon"),i=Object.keys(t);emotionsTotal.push({emotion:"All",total:emotions.length,EmotionOrder:0});for(key in Object.keys(t))emotionsTotal.push({emotion:i[key],total:t[i[key]].length,EmotionOrder:t[i[key]][0].EmotionOrder});generateStructure()},complete:function(){jQuery("emotion-loader").hide()}})}function generateStructure(){generateEmotionPopupHeader();generateEmotionBody(emotions,"All");jQuery("body").append(mainReactionContainer);jQuery(mainReactionContainer).modal("show");jQuery(mainReactionContainer).bind("hidden.bs.modal",function(){emotions=[];emotionsTotal=[];isPopupOpend=!1})}function generateEmotionPopupHeader(){var i=document.createElement("div"),f,e,h,t,r,o,n,s,u;i.className="modal-header";f=jQuery("<button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true' class=''>Ã—<\/span><\/button>");jQuery(f).on("click",function(){jQuery(mainReactionContainer).fadeOut(300,function(){jQuery(mainReactionContainer).modal("hide");jQuery(mainReactionContainer).remove();emotions=[];emotionsTotal=[];isPopupOpend=!1})});jQuery(i).append(f);e=[];for(h in emotionsTotal)e.push(emotionsTotal[h]);t=e.sort(function(n,t){return n.EmotionOrder<t.EmotionOrder?-1:n.EmotionOrder>t.EmotionOrder?1:0});jQuery(emotionPopupWrapper).append(i);r=document.createElement("ul");r.className="emotion-popup-header list-unstyled";for(index in t)o="",n=document.createElement("li"),index==0?(n.className=t[index].emotion+" active",n.innerHTML="All ",n.style.cursor="pointer",n.style.color="#0086dc",n.style.fontWeight="bold"):(n.className="emotion-popup-li",n.style.position="relative",s=document.createElement("i"),s.className="d-icon "+t[index].emotion,n.appendChild(s),o="position:absolute;top:2px;left:22px"),u=document.createElement("span"),u.innerHTML=t[index].total,u.setAttribute("style",o),n.appendChild(u),n.setAttribute("onclick","filterEmotionByType('"+t[index].emotion+"',this)"),r.appendChild(n);jQuery(i).append(r);jQuery(emotionPopupWrapper).append("<span class='tab-indicator'><\/span>");modalBody=document.createElement("div");modalBody.className="modal-body emotion-body"}function generateEmotionBody(n,t){var l=document.createElement("ul"),i,u,e,o,s,r,f,a,h,c,v;l.className="emotion-listing list-unstyled";for(index in n){if(i=n[index],u=document.createElement("li"),u.className="media",e=document.createElement("div"),e.className="media-left media-top",o=document.createElement("div"),o.className="media-body media-middle",s=document.createElement("div"),s.className="media-right",r=document.createElement("a"),r.href="/members/"+i.unique_user_name,r.className="emotion-user-link",f=document.createElement("img"),f.className="user-image-36",f.src=i.UserImage,f.alt=htmlEscape(i.FullName),r.appendChild(f),t=="All"&&(a=document.createElement("span"),a.className="d-icon "+i.Icon,r.appendChild(a)),e.appendChild(r),h=r.cloneNode(),c=document.createElement("p"),c.className="title",h.innerHTML=htmlEscape(i.FullName),h.className="text-grey-700",c.appendChild(h),o.appendChild(c),v=jQuery(i.IsFollowing==0?"<button class='pill-btn' title='follow' data-authorid='"+i.AuthorId+"'><span class='follow-sign'>+&nbsp;<\/span>Follow<\/button>":i.IsFollowing==1?"<button class='pill-btn' title='Following' disabled>Following<\/button>":""),i.IsFollowing==0)v.on("click",function(){followAuthorByUserId(this)});jQuery(s).append(v);u.appendChild(e);u.appendChild(o);u.appendChild(s);l.appendChild(u)}jQuery(".emotion-listing").remove();isPopupOpend=!0;jQuery(modalBody).append(l);jQuery(emotionPopupWrapper).append(modalBody)}function followAuthorByUserId(n){if(!(typeof jQuery(n).data("isClicked")=="undefined")&&jQuery(n).data("isClicked")==!0)return!1;jQuery(n).data("isClicked",!0);var t=jQuery(n).data("authorid"),i=jQuery("ul[data-content-type]").length>0?jQuery("ul[data-content-type]").data("content-type"):"article";return jQuery.ajax({url:"/Handlers/CsharpCommon.ashx?method=author_follow_unfollow",data:{authorId:t},type:"POST",beforeSend:function(){},success:function(t){t=="login"?window.location="/login?ReturnUrl="+window.location.href:parseInt(t)==1&&jQuery(n).off("click").attr("disabled","disabled").attr("title","Following").html("Following")},complete:function(){jQuery(n).fadeTo("fast",1)}}),!1}function filterEmotionByType(n,t){if(jQuery(".emotion-popup-wrapper .tab-indicator").animate({left:jQuery(t).position().left+(n=="All"?-5:-2),width:jQuery(t).innerWidth()-10},300),jQuery(".emotion-popup-header li").removeClass("active"),jQuery(t).addClass("active"),jQuery("ul.emotion-popup-header li").children("span").css("color","#8d8d8d").css("font-weight","normal"),jQuery("ul.emotion-popup-header li.active").children("span").css("color","#0086dc").css("font-weight","bold"),n=="All")jQuery(".emotion-popup-wrapper .tab-indicator").css("background-color",""),generateEmotionBody(emotions,n),jQuery("ul.emotion-popup-header li.active").css("color","#0086dc").css("font-weight","bold");else{jQuery("ul.emotion-popup-header li").css("color","#8d8d8d").css("font-weight","normal");var i=[];jQuery(emotions).map(function(t,r){r.Icon==n&&i.push(r)});generateEmotionBody(i,n)}}function htmlEscape(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function generateReasonBox(n,t){mainReactionContainer=jQuery("<div id='reasonPopup' class='modal fade' role='dialog'>                              <div class='modal-dialog'>                                <div class='modal-content'>                                  <div class='modal-header'>                                    <button type='button' id='btnReasonPopupClose' class='close' data-dismiss='modal'>&times;<\/button>                                    <h3 class='modal-title text-center h3'>Why do you think so?<\/h3>                                  <\/div>                                  <div class='modal-body'>                                    <textarea id='txtBoxReason' placeholder='We would love to hear your feedback' class='form-control' style='width:100%; height:80px;'><\/textarea>                                   <\/div>                                  <div class='modal-footer'>                                    <button type='button' class='btn btn-primary' onclick='submitReason(\""+n+'", "'+t+"\");'>Submit<\/button>                                  <\/div>                                <\/div>                              <\/div>                            <\/div>");jQuery("body").append(mainReactionContainer);jQuery(mainReactionContainer).modal("show");jQuery("#btnReasonPopupClose").click(function(){jQuery("#reasonPopup").modal("hide").remove()})}function submitReason(n,t){var i=jQuery("#txtBoxReason").val().trim();return i.length==0?(alert("Please provide reason"),!1):(jQuery.ajax({url:"/WebServices/CommonServices.asmx/SaveContentFeedback",type:"POST",contentType:"application/json",data:JSON.stringify({ContentId:n,ContentType:t.toLowerCase(),Feedback:i,Title:jQuery("title").html(),Url:window.location.href}),success:function(n){var t=n.d;t!=null&&(t.toLowerCase()==="login"?window.location="/login?ReturnUrl="+window.location.href:t.toLowerCase()=="true"?jQuery(mainReactionContainer).fadeOut(300,function(){jQuery(mainReactionContainer).modal("hide");jQuery(mainReactionContainer).remove()}):alert("Error"))},error:function(){alert("Error")}}),!1)}function createEmotionCopy(){jQuery("#commentsBox").length==0&&setTimeout(createEmotionCopy,100);var n=jQuery("#TopStatsContainer a#btnLikeAnchor").parent().html();jQuery("#BottomEmotionsContainer").html(n);jQuery("ol#TopStatsContainer").length>0&&jQuery("#BottomEmotionsContainer").html().indexOf("emotions-wrapper")>0&&(jQuery("ol#TopStatsContainer").remove(),jQuery("#BottomEmotionsContainer").parent().append("<li class='relative' title='Views'><i class='d-icon icon-view'><\/i> <span class='user-action-count'>"+jQuery("#HiddenContentStats").attr("data-views")+"<\/span><\/li>"))}var emotions=[],emotionsTotal=[],mainReactionContainer="",emotionPopupWrapper="",modalBody="",isPopupOpend=!1,isTapFirstTime=!0,isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}},groupBy;document.addEventListener("DOMContentLoaded",function(){deferEmotionLoad()});groupBy=function(n,t){return n.reduce(function(n,i){return(n[i[t]]=n[i[t]]||[]).push(i),n},{})}