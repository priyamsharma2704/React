function deferLogin(){window.jQuery?domReadyLogin():setTimeout(function(){deferLogin()},100)}function domReadyLogin(){jQuery("#UserDetailContainer").mouseover(function(){jQuery("#LogoutSpan").show()}),jQuery(".loginPopup.loggedIn").mouseover(function(){jQuery("#LogoutSpan").show(),jQuery(".userdetailCntr").addClass("hover")}),jQuery("#UserDetailContainer").mouseout(function(){jQuery("#LogoutSpan").hide()}),jQuery(".loginPopup.loggedIn").mouseout(function(){jQuery("#LogoutSpan").hide(),jQuery(".userdetailCntr").removeClass("hover")});var e=!0;jQuery(".notificationMessageCntr").click(function(){"askQuestion"!=jQuery(this)[0].id&&(jQuery(this).next().is(":visible")?(jQuery(this).find(".arrow").hide(),jQuery(this).next().hide()):(jQuery(".msg_container").hide(),jQuery(".notificationMessageCntr .arrow").hide(),e=!1,jQuery(this).find(".arrow").show(),jQuery(this).next().show(),ResetNotificationCount(this)))}),jQuery(".msg_container").click(function(){e=!1}),jQuery(document).click(function(){e&&(jQuery(".notificationMessageCntr .arrow").hide(),jQuery(".msg_container").hide()),e=!0}),jQuery(window).scroll(function(){var e=jQuery(window).scrollTop(),i=jQuery(window).width(),t=jQuery(".topHeaderConainer").height()-jQuery(".HeadermenuStripBlue").height()-jQuery("#HeaderAdvertise").height();e>t+jQuery(".HeadermenuStripBlue").height()?767>parseInt(i)?(jQuery(".HeadermenuStripBlue").css("position","fixed"),jQuery("#blankDiv").show()):jQuery(".csharp-notification").is(":visible")?(jQuery(".HeadermenuStripBlue").css({position:"fixed",top:"0px"}),jQuery("#blankDiv").show()):(jQuery(".HeadermenuStripBlue").css({position:"fixed",top:0}),jQuery("#blankDiv").show()):e<=t+jQuery(".HeadermenuStripBlue").height()&&(jQuery(".HeadermenuStripBlue").css({position:"fixed"}),jQuery("#blankDiv").hide())}),jQuery(window).resize(function(){if(jQuery(".menuButton").is(":visible")){var e=jQuery(window).height();jQuery(".responsiveHeader .responsiveMenu").css("height",e)}else jQuery(".responsiveHeader .responsiveMenu").css("height","auto")}),jQuery(".menuButton").click(function(){jQuery(window).height();var e=jQuery(".responsiveHeader .responsiveMenu");e.hasClass("hidden")?(e.removeClass("hidden"),jQuery("body").removeClass("openNav")):(e.addClass("hidden"),jQuery("body").addClass("openNav"))}),(jQuery(".icons.comments").length>0||jQuery(".icons.message").length>0||jQuery(".icons.notification").length>0)&&setInterval(function(){GetNotificationCounts()},6e4),jQuery("#HeaderSearch").length>0&&jQuery("#HeaderSearch").bind("keydown",preventQuestionMark),jQuery("#searchTextBox").length>0&&jQuery("#searchTextBox").bind("keydown",preventQuestionMark),jQuery("#TextBoxSearchText").length>0&&jQuery("#TextBoxSearchText").bind("keydown",preventQuestionMark),jQuery("#btnHeaderSearch").click(function(){jQuery("#HeaderSearch").focus()}),setTimeout(function(){"undefined"!=typeof arrInFocus&&animateinFocus()},5e3),jQuery("<style>").attr("type","text/css").html("        .scrollToTop{padding:10px 12px;position:fixed;bottom:8px;right:8px;display:none;background:#0086dc;z-index:999;-webkit-transition:all 0.3s;-moz-transition:all 0.3s;-o-transition:all 0.3s;transition:all 0.3s;} .scrollToTop:hover{background:#252525;}").appendTo("head"),jQuery("body").prepend("<span  aria-label='scroll to top' class='scrollToTop'>                            <svg width='20px' height='20px' viewBox='0 0 20 20'>                                <polygon fill='#FFFFFF' points='10,3.9 0,13.9 2.2,16.1 10,8.3 17.8,16.1 20,13.9 10,3.9 10,3.9 '/>                            </svg></span>"),jQuery(window).scroll(function(){jQuery(this).scrollTop()>100?jQuery(".scrollToTop").fadeIn():jQuery(".scrollToTop").fadeOut()}),jQuery(".scrollToTop").click(function(){return jQuery("html, body").animate({scrollTop:0},800),!1}),jQuery(".msg_container ul").bind("mousewheel",function(e){e.originalEvent.wheelDelta/120<=0&&jQuery(this).find("li").last().offset().top<=jQuery(this).height()&&(e.preventDefault(),e.stopPropagation())}),-1===["advertiser"].indexOf(window.location.href.toLowerCase().replace(/^https?:\/\//,"").split("/")[1])&&setTimeout(function(){jQuery("#HeaderAdvertise").length>0&&GetHeaderAd()},1200)}function getUserTimeZoneOffset(){let e=new Date().getTimezoneOffset();return e}function calculateTimeAgo(e){let i=new Date,t=getUserTimeZoneOffset(),o=new Date(e),n=new Date(o.getTime()-6e4*t),s=(i-n)/1e3,a=86400,r=Math.floor(s/a),c=s%a,l=Math.floor(c/3600),h=Math.floor(c%3600/60);return r>=1?r+" day"+(1===r?"":"s")+" ago":l>=1?l+" hrs "+h+" min ago":(h<0?0:h)+(1===h||h<=0?" min":" mins")+" ago"}function ResetNotificationCount(e){var i=0;"messageNotification"==jQuery(e).attr("id")?i=1:"commentNotification"==jQuery(e).attr("id")?i=2:"generalNotifications"==jQuery(e).attr("id")&&(i=3),0!=i&&jQuery.ajax({url:"/Handlers/CsharpCommon.ashx?method=reset_notification_message_count&type="+i,type:"POST",async:!1,dataType:"JSON",contentType:"application/JSON",beforeSend:function(){1==i&&jQuery("#imgComments").show(),2==i&&jQuery("#imgMessages").show(),3==i&&jQuery("#imgGeneralNotifications").show()},success:function(t){if(jQuery(e).find(".messageCount").hide(),null!=t&&""!=t){if("login"==t)return jQuery("#LabelNoDataNotifications").show(),!1;var o="";1==i?(o="",jQuery(t).each(function(){let e=this.Date,i=calculateTimeAgo(e);""===this.GroupImageUrl&&(this.GroupImageUrl="/UploadFile/AuthorImage/DefaultAuthorImage.gif"),"No"===this.SupportUser||"Notification"===this.SupportUser?o+="<li class='newdvMessages'><a href='"+this.GroupUrl+"' title='"+this.GroupName+"' class='pic newpic'> <img src='"+this.GroupImageUrl+"' alt='"+this.GroupName+"' width=\"55\" height=\"55\"/></a><div class='newright_content'> <a href='"+this.MemberUrl+"'>"+this.Name+"</a><span class='newnotificationDate'>"+i+"</span><a class='goupName' href='"+this.GroupUrl+"'><b>"+this.GroupName+"</b></a><a class='text'href='"+this.GroupUrl+"'>"+this.Subject+"</a></div></li>":o+="<li class='newdvMessages'><a href='"+this.MemberUrl+"' title='"+this.Name+"' class='pic'> <img src='"+this.PhotoUrl+"' alt='"+this.Name+"'  width=\"45\" height=\"45\"/></a><div class='newright_content'> <a href='"+this.MemberUrl+"'>"+this.Name+"</a><span class='newnotificationDate'>"+i+"</span><a class='text' href='"+this.MessageURL+"'>"+this.Subject+"</a></div></li>"}),jQuery("#dvMessages").empty(),jQuery("#dvMessages").html(o)):2==i?(o="",jQuery(t).each(function(){o+="<li><a href='"+this.MemberUrl+"' title='"+this.Name+"' class='pic'><img src='"+this.PhotoUrl+"'  alt='"+this.Name+"' width=\"45\" height=\"45\" /></a><div class='right_content'><div> <a href='"+this.ArticleUrl+"'>"+(this.Comment.length>100?this.Comment.substring(0,100)+"...":this.Comment)+"</a></div><div><span class='notificationDate'>"+this.Date+"</span></div></div></li>"}),jQuery("#dvComments").empty(),jQuery("#dvComments").html(o)):(o="",jQuery(t).each(function(){o+="<li>"+this.Message+"<div class='notificationDate'>"+this.CreatedDate+"</div></li>"}),jQuery("#dvGeneralNotifications").empty(),jQuery("#dvGeneralNotifications").html(o))}else 1==i?jQuery("#LabelNoData").show():2==i?jQuery("#LabelNoComments").show():jQuery("#LabelNoDataNotifications").show()},complete:function(){1==i&&(jQuery("#imgMessages").hide(),jQuery(".icons.message")[0].title="You have no unread message"),2==i&&(jQuery("#imgComments").hide(),jQuery(".icons.comments")[0].title="You have no unread comment"),3==i&&(jQuery("#imgGeneralNotifications").hide(),jQuery(".icons.notification")[0].title="You have no unread notification")}})}function GetNotificationCounts(){jQuery.ajax({url:"/WebServices/CommonServices.asmx/GetNotificationCount",type:"POST",dataType:"JSON",contentType:"application/json",success:function(e){if(jQuery(".loginControl .messageCount").html("").hide(),null!=e.d){var i=JSON.parse(e.d),t=i[0].NotificationMessageCount,o=i[0].NotificationGeneralCount,n=i[0].NotificationCommentCount;0!=n&&0!=jQuery(".icons.comments").length&&(jQuery("#spanCommentsNotifications").html(n).show(),jQuery(".icons.comments")[0].title="You have "+(0==n?"no":n)+" unread comment"+(n>1?"s":"")),0!=t&&0!=jQuery(".icons.message").length&&(jQuery("#spanMessages").html(t).show(),jQuery(".icons.message")[0].title="You have "+(0==t?"no":t)+" unread message"+(t>1?"s":"")),0!=o&&0!=jQuery(".icons.notification").length&&(jQuery("#spanGeneralNotifications").html(o).show(),jQuery(".icons.notification")[0].title="You have "+(0==o?"no":o)+" unread notification"+(o>1?"s":""))}},error:function(e){console.log("Error")}})}function logout(){jQuery.ajax({type:"POST",url:"/WebServices/CommonServices.asmx/LogOffUser",contentType:"application/json; charset=utf-8",beforeSend:function(){jQuery(".logout.loader").show()},dataType:"json",success:function(e){!0===e.d&&(clearCookies(),window.location=window.location.pathname)},complete:function(){jQuery(".logout.loader").hide()}})}function clearCookies(){var e=new Date;e.setDate(e.getDate()+30);var i="",t="",o="";document.cookie.indexOf("notificationId")>-1&&(i=document.cookie.substr(document.cookie.indexOf("notificationId"))+";expires="+e.toUTCString()+";path=/"),document.cookie.indexOf("GBID")>-1&&(t=document.cookie.substr(document.cookie.indexOf("GBID"))+";expires="+e.toUTCString()+";path=/"),document.cookie.indexOf("FilterRecent")>-1&&(o=document.cookie.substr(document.cookie.indexOf("FilterRecent"))+";path=/"),document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+new Date().toUTCString()+";path=/")}),""!==i&&(document.cookie=i),""!==t&&(document.cookie=t),""!==o&&(document.cookie=o)}function preventQuestionMark(e){return 191!==(e.which?e.which:e.keyCode)}deferLogin();